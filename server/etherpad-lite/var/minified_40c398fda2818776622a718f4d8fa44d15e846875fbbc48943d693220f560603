require.define({"ep_author_follow/static/js/follow.js": {"(module ep_author_follow/static/js/follow.js)": function (require, exports, module) {"use strict";const padcookie=require("ep_etherpad-lite/static/js/pad_cookie").padcookie,Changeset=require("ep_etherpad-lite/static/js/Changeset");exports.postAceInit=()=>{isEditingTimeout(),settingsListeners(),loadSettings(),appendUI()},exports.handleClientMessage_NEW_CHANGES=(o,e)=>{if(!clientVars.ep_author_follow.isEditing&&clientVars.ep_author_follow.enableFollow){const l=Changeset.opIterator(Changeset.unpack(e.payload.changeset).ops).next().lines,t=e.payload.author;(followingAuthor(t)||clientVars.ep_author_follow.followAll)&&goToLineNumber(l)}},exports.handleClientMessage_ACCEPT_COMMIT=(o,e)=>{clientVars.ep_author_follow.isEditing=!0,clientVars.ep_author_follow.editingTimeout=setTimeout(()=>{clientVars.ep_author_follow.isEditing=!1},5e3)};const appendUI=()=>{$("body").on("click","#otheruserstable > tbody > tr",function(){const o=$(this).data("authorid");clientVars.ep_author_follow.following[o]?($(this).find("td > div").text(""),unfollow(o)):(follow(o),$(this).find("td > div").text("\u{1F441}"),$(this).find("td > div").css({"font-size":"12px",color:"#666","line-height":"17px","padding-left":"3px"}))})},follow=o=>{clientVars.ep_author_follow.following[o]=!0,padcookie.setPref("ep_author_follow.following",JSON.stringify(clientVars.ep_author_follow.following)),updateFollowingUI()},unfollow=o=>{delete clientVars.ep_author_follow.following[o],padcookie.setPref("ep_author_follow.following",JSON.stringify(clientVars.ep_author_follow.following)),updateFollowingUI()},followingAuthor=o=>clientVars.ep_author_follow.following[o],goToLineNumber=o=>{const e=$('iframe[name="ace_outer"]').contents().find("iframe").contents().find("#innerdocbody"),l=$('iframe[name="ace_outer"]').contents().find("#outerdocbody"),t=$('iframe[name="ace_outer"]').contents().find("#outerdocbody").parent(),i=e.find(`div:nth-child(${o+1})`),n=`${$(i)[0].offsetTop}px`;l.css({top:`${n}px`}),t.animate({scrollTop:n})},settingsListeners=()=>{$("#options-followAll").on("change",function(){clientVars.ep_author_follow.followAll=!clientVars.ep_author_follow.followAll,padcookie.setPref("ep_author_follow.followAll",$(this).prop("checked")),$(this).prop("checked")&&(clientVars.ep_author_follow.enableFollow=!0,$("#options-enableFollow").prop("checked",!0)),updateFollowingUI()}),$("#options-enableFollow").on("click",function(){clientVars.ep_author_follow.enableFollow=!clientVars.ep_author_follow.enableFollow,padcookie.setPref("ep_author_follow.enableFollow",$(this).prop("checked"))})},loadSettings=()=>{clientVars.ep_author_follow.following={},padcookie.getPref("ep_author_follow.enableFollow")?(clientVars.ep_author_follow.enableFollow=!0,$("#options-enableFollow").prop("checked",!0)):padcookie.getPref("ep_author_follow.enableFollow")===!1&&(clientVars.ep_author_follow.enableFollow=!1,$("#options-enableFollow").prop("checked",!1)),padcookie.getPref("ep_author_follow.followAll")?(clientVars.ep_author_follow.followAll=!0,$("#options-followAll").prop("checked",!0)):padcookie.getPref("ep_author_follow.followAll")===!1&&(clientVars.ep_author_follow.followAll=!1,$("#options-followAll").prop("checked",!1)),padcookie.getPref("ep_author_follow.following")&&(clientVars.ep_author_follow.following=JSON.parse(padcookie.getPref("ep_author_follow.following")),updateFollowingUI()),clientVars.ep_author_follow.followAll&&$("#options-followAll").prop("checked",!0),clientVars.ep_author_follow.enableFollow&&$("#options-enableFollow").prop("checked",!0)},updateFollowingUI=()=>{const o=$("#otheruserstable").contents().find("tr");if($.each(o,function(){$(this).find("td > div").text("")}),clientVars.ep_author_follow.followAll){const e=$("#otheruserstable").contents().find("tr");$.each(e,function(){$(this).find("td > div").text("\u{1F441}"),$(this).find("td > div").css({"font-size":"12px",color:"#666","line-height":"17px","padding-left":"3px"})})}else $.each(clientVars.ep_author_follow.following,e=>{const l=$("#otheruserstable").contents().find(`[data-authorid='${e}']`);$(l).find("td > div").text("\u{1F441}"),$(l).find("td > div").css({"font-size":"12px",color:"#666","line-height":"17px","padding-left":"3px"})})},isEditingTimeout=()=>{clientVars.ep_author_follow.isEditing=!0,clientVars.ep_author_follow.editingTimeout=setTimeout(()=>{clientVars.ep_author_follow.isEditing=!1},1e3)};
}}["(module ep_author_follow/static/js/follow.js)"],
});
