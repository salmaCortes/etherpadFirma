(function(n){var M=n.fn.domManip,g="_tmplitem",H=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,c={},w={},v,L={key:0,data:{}},k=0,d=0,N=[];function T(t,e,i,l){var p={data:l||(e?e.data:{}),_wrap:e?e._wrap:null,tmpl:null,parent:e||null,nodes:[],calls:C,nest:q,wrap:F,html:O,update:S};return t&&n.extend(p,t,{nodes:[],parent:e}),i&&(p.tmpl=i,p._ctnt=p._ctnt||p.tmpl(n,p),p.key=++k,(N.length?w:c)[k]=p),p}n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){n.fn[t]=function(i){var l=[],p=n(i),r,o,m,s,a=this.length===1&&this[0].parentNode;if(v=c||{},a&&a.nodeType===11&&a.childNodes.length===1&&p.length===1)p[e](this[0]),l=this;else{for(o=0,m=p.length;o<m;o++)d=o,r=(o>0?this.clone(!0):this).get(),n.fn[e].apply(n(p[o]),r),l=l.concat(r);d=0,l=this.pushStack(l,t,p.selector)}return s=v,v=null,n.tmpl.complete(s),l}}),n.fn.extend({tmpl:function(t,e,i){return n.tmpl(this[0],t,e,i)},tmplItem:function(){return n.tmplItem(this[0])},template:function(t){return n.template(t,this[0])},domManip:function(t,e,i){if(t[0]&&t[0].nodeType){for(var l=n.makeArray(arguments),p=t.length,r=0,o;r<p&&!(o=n.data(t[r++],"tmplItem")););p>1&&(l[0]=[n.makeArray(t)]),o&&d&&(l[2]=function(m){n.tmpl.afterManip(this,m,i)}),M.apply(this,l)}else M.apply(this,arguments);return d=0,!v&&n.tmpl.complete(c),this}}),n.extend({tmpl:function(t,e,i,l){var p,r=!l;if(r)l=L,t=n.template[t]||n.template(null,t),w={};else if(!t)return t=l.tmpl,c[l.key]=l,l.nodes=[],l.wrapped&&E(l,l.wrapped),n(A(l,null,l.tmpl(n,l)));return t?(typeof e=="function"&&(e=e.call(l||{})),i&&i.wrapped&&E(i,i.wrapped),p=n.isArray(e)?n.map(e,function(o){return o?T(i,l,t,o):null}):[T(i,l,t,e)],r?n(A(l,null,p)):p):[]},tmplItem:function(t){var e;for(t instanceof n&&(t=t[0]);t&&t.nodeType===1&&!(e=n.data(t,"tmplItem"))&&(t=t.parentNode););return e||L},template:function(t,e){return e?(typeof e=="string"?e=B(e):e instanceof n&&(e=e[0]||{}),e.nodeType&&(e=n.data(e,"tmpl")||n.data(e,"tmpl",B(e.innerHTML))),typeof t=="string"?n.template[t]=e:e):t?typeof t!="string"?n.template(null,t):n.template[t]||n.template(null,H.test(t)?t:n(t)):null},encode:function(t){return(""+t).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),n.extend(n.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},if:{open:"if(($notnull_1) && $1a){",close:"}"},else:{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(){c={}},afterManip:function(t,e,i){var l=e.nodeType===11?n.makeArray(e.childNodes):e.nodeType===1?[e]:[];i.call(t,e),Q(l),d++}});function A(t,e,i){var l,p=i?n.map(i,function(r){return typeof r=="string"?t.key?r.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+g+'="'+t.key+'" $2'):r:A(r,t,r._ctnt)}):t;return e?p:(p=p.join(""),p.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(r,o,m,s){l=n(m).get(),Q(l),o&&(l=x(o).concat(l)),s&&(l=l.concat(x(s)))}),l||x(p))}function x(t){var e=document.createElement("div");return e.innerHTML=t,n.makeArray(e.childNodes)}function B(t){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+n.trim(t).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(e,i,l,p,r,o,m){var s=n.tmpl.tag[l],a,y,f;if(!s)throw"Template command not found: "+l;return a=s._default||[],o&&!/\w$/.test(r)&&(r+=o,o=""),r?(r=I(r),m=m?","+I(m)+")":o?")":"",y=o?r.indexOf(".")>-1?r+o:"("+r+").call($item"+m:r,f=o?y:"(typeof("+r+")==='function'?("+r+").call($item):("+r+"))"):f=y=a.$1||"null",p=I(p),"');"+s[i?"close":"open"].split("$notnull_1").join(r?"typeof("+r+")!=='undefined' && ("+r+")!=null":"true").split("$1a").join(f).split("$1").join(y).split("$2").join(p?p.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function($,u,_,h){return h=h?","+h+")":_?")":"",h?"("+u+").call($item"+h:$}):a.$2||"")+"_.push('"})+"');}return _;")}function E(t,e){t._wrap=A(t,!0,n.isArray(e)?e:[H.test(e)?e:n(e).html()]).join("")}function I(t){return t?t.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function W(t){var e=document.createElement("div");return e.appendChild(t.cloneNode(!0)),e.innerHTML}function Q(t){var e="_"+d,i,l,p={},r,o,m;for(r=0,o=t.length;r<o;r++)if((i=t[r]).nodeType===1){for(l=i.getElementsByTagName("*"),m=l.length-1;m>=0;m--)s(l[m]);s(i)}function s(a){var y,f=a,$,u,_;if(_=a.getAttribute(g)){for(;f.parentNode&&(f=f.parentNode).nodeType===1&&!(y=f.getAttribute(g)););y!==_&&(f=f.parentNode?f.nodeType===11?0:f.getAttribute(g)||0:0,(u=c[_])||(u=w[_],u=T(u,c[f]||w[f],null,!0),u.key=++k,c[k]=u),d&&h(_)),a.removeAttribute(g)}else d&&(u=n.data(a,"tmplItem"))&&(h(u.key),c[u.key]=u,f=n.data(a.parentNode,"tmplItem"),f=f?f.key:0);if(u){for($=u;$&&$.key!=f;)$.nodes.push(a),$=$.parent;delete u._ctnt,delete u._wrap,n.data(a,"tmplItem",u)}function h(j){j=j+e,u=p[j]=p[j]||T(u,c[u.parent.key+e]||u.parent,null,!0)}}}function C(t,e,i,l){if(!t)return N.pop();N.push({_:t,tmpl:e,item:this,data:i,options:l})}function q(t,e,i){return n.tmpl(n.template(t),e,i,this)}function F(t,e){var i=t.options||{};return i.wrapped=e,n.tmpl(n.template(t.tmpl),t.data,i,t.item)}function O(t,e){var i=this._wrap;return n.map(n(n.isArray(i)?i.join(""):i).filter(t||"*"),function(l){return e?l.innerText||l.textContent:l.outerHTML||W(l)})}function S(){var t=this.nodes;n.tmpl(null,null,null,this).insertBefore(t[0]),n(t).remove()}})(jQuery);
